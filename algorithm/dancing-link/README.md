舞蹈链算法是一种用来求解“精确覆盖问题（exact cover problem）”的算法，它采用十字双向环形链表，回溯效率非常高。

精确覆盖问题（exact cover problem）：给定一个由0-1组成的矩阵，是否能找到一个行集合，使得集合中每一列都恰好包含一个 1 ？

例如，下面的矩阵：

    [[0, 0, 1, 0, 1, 1, 0],
     [1, 0, 0, 1, 0, 0, 1],
     [0, 1, 1, 0, 0, 1, 0],
     [1, 0, 0, 1, 0, 0, 0],
     [0, 1, 0, 0, 0, 0, 1],
     [0, 0, 0, 1, 1, 0, 1]]

就含有一个这样的行集合：

     [0, 0, 1, 0, 1, 1, 0] （第 0 行）
     [1, 0, 0, 1, 0, 0, 0] （第 3 行）
     [0, 1, 0, 0, 0, 0, 1] （第 4 行）

这个集合中，每一列都含有一个 1 ，且只含有一个 1 。

很多问题可以转化为精确覆盖问题，其中包括数独游戏的求解。

dancing_link.pdf 是 Donald E. Knuth 的关于舞蹈链算法的论文。dancinglink 目录下是本人用 python 实现的舞蹈链算法，以及数独游戏的求解算法，就是参照 Knuth 的论文实现的。

test_exact_cover.py 和 test_sudoku.py 分别是求解精确覆盖问题和求解数独游戏的测试文件。

test_exact_cover.py 中内容如下。其中矩阵采用稀疏矩阵存储，如 matrixRows[0] = [2,4,5] 表示矩阵的第 0 行的第 2, 4, 5 列为 1 ，其余为 0 ；matrixWidth 是矩阵的宽度，也就是列数。

import dancinglink

# matrixRows and matrixWidth represent matrix below:
#   [[0, 0, 1, 0, 1, 1, 0],
#    [1, 0, 0, 1, 0, 0, 1],
#    [0, 1, 1, 0, 0, 1, 0],
#    [1, 0, 0, 1, 0, 0, 0],
#    [0, 1, 0, 0, 0, 0, 1],
#    [0, 0, 0, 1, 1, 0, 1]]
# each j in matrixRows[i] means matrix[i][j] = 1
matrixRows = [ 
    [2, 4, 5],
    [0, 3, 6],
    [1, 2, 5],
    [0, 3],
    [1, 6],
    [3, 4, 6]
]
matrixWidth = 7
for solution in dancinglink.solve(matrixRows, matrixWidth):
    print solution

运行 test_exact_cover.py 后，输出：[0, 3, 4]


test_sudoku.py 中内容如下。数独题目由一个字符串表示，其中 "." 表示空白块。数独游戏是一个 9 x 9 的板，要求空白块填入数字，使得板上的每一行、每一列、每一个 3 x 3 区都含有 "1 2 3 4 5 6 7 8 9" 。

import dancinglink

board = """53..7....
           6..195...
           .98....6.
           8...6...3
           4..8.3..1
           7...2...6
           .6....28.
           ...419..5
           ....8..79"""
dancinglink.solve_sudoku(board)

运行后，输出：

the sudoku puzzle:
++===+===+===++===+===+===++===+===+===++
|| 5 | 3 |   ||   | 7 |   ||   |   |   ||
++---+---+---++---+---+---++---+---+---++
|| 6 |   |   || 1 | 9 | 5 ||   |   |   ||
++---+---+---++---+---+---++---+---+---++
||   | 9 | 8 ||   |   |   ||   | 6 |   ||
++===+===+===++===+===+===++===+===+===++
|| 8 |   |   ||   | 6 |   ||   |   | 3 ||
++---+---+---++---+---+---++---+---+---++
|| 4 |   |   || 8 |   | 3 ||   |   | 1 ||
++---+---+---++---+---+---++---+---+---++
|| 7 |   |   ||   | 2 |   ||   |   | 6 ||
++===+===+===++===+===+===++===+===+===++
||   | 6 |   ||   |   |   || 2 | 8 |   ||
++---+---+---++---+---+---++---+---+---++
||   |   |   || 4 | 1 | 9 ||   |   | 5 ||
++---+---+---++---+---+---++---+---+---++
||   |   |   ||   | 8 |   ||   | 7 | 9 ||
++===+===+===++===+===+===++===+===+===++

solution:
++===+===+===++===+===+===++===+===+===++
|| 5 | 3 | 4 || 6 | 7 | 8 || 9 | 1 | 2 ||
++---+---+---++---+---+---++---+---+---++
|| 6 | 7 | 2 || 1 | 9 | 5 || 3 | 4 | 8 ||
++---+---+---++---+---+---++---+---+---++
|| 1 | 9 | 8 || 3 | 4 | 2 || 5 | 6 | 7 ||
++===+===+===++===+===+===++===+===+===++
|| 8 | 5 | 9 || 7 | 6 | 1 || 4 | 2 | 3 ||
++---+---+---++---+---+---++---+---+---++
|| 4 | 2 | 6 || 8 | 5 | 3 || 7 | 9 | 1 ||
++---+---+---++---+---+---++---+---+---++
|| 7 | 1 | 3 || 9 | 2 | 4 || 8 | 5 | 6 ||
++===+===+===++===+===+===++===+===+===++
|| 9 | 6 | 1 || 5 | 3 | 7 || 2 | 8 | 4 ||
++---+---+---++---+---+---++---+---+---++
|| 2 | 8 | 7 || 4 | 1 | 9 || 6 | 3 | 5 ||
++---+---+---++---+---+---++---+---+---++
|| 3 | 4 | 5 || 2 | 8 | 6 || 1 | 7 | 9 ||
++===+===+===++===+===+===++===+===+===++

注意，本程序不检查输入的错误，需按要求输入矩阵或数独的题目。
